<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>VR –ò–≥—Ä–∞: –°–±–æ—Ä –æ–±—ä–µ–∫—Ç–æ–≤</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-physics-system@4.0.1/dist/aframe-physics-system.min.js"></script>
</head>
<body>
    <a-scene physics="gravity: -9.8;">
        <!-- –ê—Å—Å–µ—Ç—ã (—Ä–µ—Å—É—Ä—Å—ã) -->
        <a-assets>
            <!-- –ó–∞–≥–ª—É—à–∫–∏ –¥–ª—è –∑–≤—É–∫–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ URL A-Frame) -->
            <audio id="collect-sound" src="https://cdn.aframe.io/360-image-gallery-boilerplate/audio/click.ogg"></audio>
            <audio id="game-over-sound" src="https://cdn.aframe.io/360-image-gallery-boilerplate/audio/percussion.ogg"></audio>
            
            <!-- –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –Ω–µ–±–æ—Å–∫–ª–æ–Ω –≤–º–µ—Å—Ç–æ —Ç–µ–∫—Å—Ç—É—Ä—ã -->
            <canvas id="skyCanvas" width="2048" height="1024"></canvas>
        </a-assets>
        
        <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Å–∫–∞–π–±–æ–∫—Å -->
        <a-sky id="dynamic-sky" radius="100"></a-sky>
        
        <!-- –ü–æ–ª —Å —Ñ–∏–∑–∏–∫–æ–π -->
        <a-plane 
            id="ground"
            static-body
            position="0 0 0" 
            rotation="-90 0 0" 
            width="50" 
            height="50" 
            color="#4a752c"
            roughness="0.8"
        ></a-plane>
        
        <!-- –°—Ç–µ–Ω—ã –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ -->
        <a-box static-body position="0 2.5 -25" width="50" height="5" depth="0.5" color="#8B4513"></a-box>
        <a-box static-body position="0 2.5 25" width="50" height="5" depth="0.5" color="#8B4513"></a-box>
        <a-box static-body position="-25 2.5 0" width="0.5" height="5" depth="50" color="#8B4513"></a-box>
        <a-box static-body position="25 2.5 0" width="0.5" height="5" depth="50" color="#8B4513"></a-box>
        
        <!-- –ò–≥—Ä–æ–∫ -->
        <a-entity id="player" 
                  position="0 3 5"
                  kinematic-body>
            <a-entity camera
                position="0 1.6 0"
                look-controls="pointerLockEnabled: true"
                wasd-controls="acceleration: 80; fly: false"
                cursor="rayOrigin: mouse">
                <a-cursor 
                    id="cursor"
                    color="#4CC3D9"
                    animation__click="property: scale; startEvents: click; from: 0.1 0.1 0.1; to: 1 1 1; dur: 150"
                ></a-cursor>
            </a-entity>
            
            <!-- –í–∏–¥–∏–º—ã–π –∫–æ–ª–ª–∞–π–¥–µ—Ä –¥–ª—è –∏–≥—Ä–æ–∫–∞ -->
            <a-box 
                id="player-collider"
                position="0 -0.8 0"
                width="1"
                height="2"
                depth="1"
                material="visible: false;"
                static-body
            ></a-box>
        </a-entity>
        
        <!-- UI: –°—á–µ—Ç -->
        <a-entity position="0 2.5 -1.5">
            <a-text 
                id="score-text" 
                value="–°—á–µ—Ç: 0" 
                position="0 0 0" 
                color="#FFFFFF" 
                align="center"
                scale="2 2 2"
                font="mozillavr"
            ></a-text>
        </a-entity>
        
        <!-- UI: –¢–∞–π–º–µ—Ä -->
        <a-entity position="0 2 -1.5">
            <a-text 
                id="timer-text" 
                value="–í—Ä–µ–º—è: 60" 
                position="0 0 0" 
                color="#FFFFFF" 
                align="center"
                scale="1.5 1.5 1.5"
                font="mozillavr"
            ></a-text>
        </a-entity>
        
        <!-- UI: –ü—Ä–æ–≥—Ä–µ—Å—Å -->
        <a-entity position="0 1.5 -1.5">
            <a-text 
                id="progress-text" 
                value="–û–±—ä–µ–∫—Ç—ã: 0/20" 
                position="0 0 0" 
                color="#FFFFFF" 
                align="center"
                scale="1.5 1.5 1.5"
                font="mozillavr"
            ></a-text>
        </a-entity>
        
        <!-- UI: –°–æ–æ–±—â–µ–Ω–∏—è -->
        <a-entity id="game-messages" position="0 0 -1.5"></a-entity>
        
        <!-- –û—Å–≤–µ—â–µ–Ω–∏–µ -->
        <a-light type="ambient" color="#FFFFFF" intensity="0.8"></a-light>
        <a-light type="directional" color="#FFFFFF" intensity="1" position="-1 3 1"></a-light>
        
        <!-- –û–±–ª–∞–∫–∞-–¥–µ–∫–æ—Ä–∞—Ü–∏–∏ -->
        <a-entity id="clouds-container"></a-entity>
    </a-scene>
    
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–≥—Ä—ã
        let score = 0;
        let timeLeft = 60;
        let gameActive = true;
        let timerInterval;
        let collectedObjects = 0;
        const totalObjects = 20; // –£–º–µ–Ω—å—à–µ–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        let objects = []; // –ú–∞—Å—Å–∏–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤
        
        // –°–æ–∑–¥–∞–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –Ω–µ–±–æ—Å–∫–ª–æ–Ω
        function createSkyGradient() {
            const canvas = document.getElementById('skyCanvas');
            const ctx = canvas.getContext('2d');
            
            // –°–æ–∑–¥–∞–µ–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç (–æ—Ç —Å–∏–Ω–µ–≥–æ –∫ –≥–æ–ª—É–±–æ–º—É)
            const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, '#87CEEB'); // –ì–æ–ª—É–±–æ–π (–≤–µ—Ä—Ö)
            gradient.addColorStop(0.5, '#4682B4'); // –°—Ç–∞–ª—å–Ω–æ–π —Å–∏–Ω–∏–π (—Å–µ—Ä–µ–¥–∏–Ω–∞)
            gradient.addColorStop(1, '#1E90FF'); // –î–æ–¥–∂–µ—Ä-–±–ª—é–∑ (–Ω–∏–∑)
            
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–ª–Ω—Ü–µ
            ctx.fillStyle = '#FFD700';
            ctx.beginPath();
            ctx.arc(canvas.width * 0.8, canvas.height * 0.2, 60, 0, Math.PI * 2);
            ctx.fill();
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º canvas –∫–∞–∫ —Ç–µ–∫—Å—Ç—É—Ä—É
            const sky = document.getElementById('dynamic-sky');
            sky.setAttribute('material', {
                src: '#skyCanvas',
                transparent: false
            });
        }
        
        // –°–æ–∑–¥–∞–µ–º –æ–±–ª–∞–∫–∞
        function createClouds() {
            const container = document.getElementById('clouds-container');
            
            for (let i = 0; i < 10; i++) {
                const cloud = document.createElement('a-entity');
                const x = Math.random() * 100 - 50;
                const z = Math.random() * 100 - 50;
                const y = 15 + Math.random() * 10;
                const scale = 3 + Math.random() * 4;
                
                cloud.setAttribute('position', `${x} ${y} ${z}`);
                cloud.setAttribute('scale', `${scale} ${scale/3} ${scale}`);
                
                // –°–æ–∑–¥–∞–µ–º –≥—Ä—É–ø–ø—É —Å—Ñ–µ—Ä –¥–ª—è –æ–±–ª–∞–∫–∞
                for (let j = 0; j < 5; j++) {
                    const sphere = document.createElement('a-sphere');
                    const offsetX = (Math.random() - 0.5) * 2;
                    const offsetZ = (Math.random() - 0.5) * 2;
                    const radius = 0.8 + Math.random() * 0.4;
                    
                    sphere.setAttribute('position', `${offsetX} 0 ${offsetZ}`);
                    sphere.setAttribute('radius', radius);
                    sphere.setAttribute('material', 'color: #FFFFFF; opacity: 0.9');
                    cloud.appendChild(sphere);
                }
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –æ–±–ª–∞–∫–∞
                cloud.setAttribute('animation', {
                    property: 'position',
                    to: `${x + (Math.random() - 0.5) * 20} ${y} ${z + (Math.random() - 0.5) * 20}`,
                    dur: 20000 + Math.random() * 20000,
                    loop: true,
                    easing: 'linear'
                });
                
                container.appendChild(cloud);
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
        function createCollectibles(count) {
            const scene = document.querySelector('a-scene');
            
            // –ú–∞—Å—Å–∏–≤ —Ü–≤–µ—Ç–æ–≤
            const colors = ['#FFD700', '#C0C0C0', '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD', '#98D8C8'];
            
            for (let i = 0; i < count; i++) {
                // –°–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
                const x = Math.random() * 40 - 20;
                const z = Math.random() * 40 - 20;
                const y = 0.5;
                
                // –°–ª—É—á–∞–π–Ω—ã–π —Ç–∏–ø
                const types = ['sphere', 'box', 'cylinder', 'cone'];
                const type = types[Math.floor(Math.random() * types.length)];
                
                // –°–ª—É—á–∞–π–Ω—ã–π —Ü–≤–µ—Ç
                const color = colors[Math.floor(Math.random() * colors.length)];
                
                // –°–ª—É—á–∞–π–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
                const value = Math.floor(Math.random() * 10) + 1;
                
                // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç
                let element;
                
                switch(type) {
                    case 'sphere':
                        element = document.createElement('a-sphere');
                        element.setAttribute('radius', '0.4');
                        break;
                    case 'box':
                        element = document.createElement('a-box');
                        element.setAttribute('width', '0.8');
                        element.setAttribute('height', '0.8');
                        element.setAttribute('depth', '0.8');
                        break;
                    case 'cylinder':
                        element = document.createElement('a-cylinder');
                        element.setAttribute('radius', '0.3');
                        element.setAttribute('height', '0.8');
                        break;
                    case 'cone':
                        element = document.createElement('a-cone');
                        element.setAttribute('radius-bottom', '0.4');
                        element.setAttribute('height', '1');
                        break;
                }
                
                // –û–±—â–∏–µ –∞—Ç—Ä–∏–±—É—Ç—ã
                element.setAttribute('class', 'collectible');
                element.setAttribute('position', `${x} ${y} ${z}`);
                element.setAttribute('color', color);
                element.setAttribute('metalness', '0.7');
                element.setAttribute('roughness', '0.3');
                element.setAttribute('data-value', value);
                element.setAttribute('static-body', '');
                element.setAttribute('id', `collectible-${i}`);
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è
                element.setAttribute('animation', {
                    property: 'rotation',
                    to: `0 ${360} 0`,
                    dur: 3000 + Math.random() * 4000,
                    loop: true,
                    easing: 'linear'
                });
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –ø–ª–∞–≤–∞–Ω–∏—è
                element.setAttribute('animation__bounce', {
                    property: 'position',
                    to: `${x} ${y + 0.5} ${z}`,
                    dir: 'alternate',
                    dur: 1500 + Math.random() * 1000,
                    loop: true,
                    easing: 'easeInOutSine'
                });
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å—Ü–µ–Ω—É –∏ –º–∞—Å—Å–∏–≤
                scene.appendChild(element);
                objects.push(element);
            }
            
            console.log(`–°–æ–∑–¥–∞–Ω–æ ${objects.length} –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è —Å–±–æ—Ä–∞`);
        }
        
        // –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
        function initCollisionDetection() {
            const playerCollider = document.getElementById('player-collider');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è –∫–∞–∂–¥—ã–µ 100–º—Å
            setInterval(() => {
                if (!gameActive) return;
                
                const playerPos = playerCollider.getAttribute('position');
                
                objects.forEach((obj, index) => {
                    if (!obj.parentNode) {
                        objects.splice(index, 1);
                        return;
                    }
                    
                    const objPos = obj.getAttribute('position');
                    const distance = Math.sqrt(
                        Math.pow(playerPos.x - objPos.x, 2) +
                        Math.pow(playerPos.y - objPos.y, 2) +
                        Math.pow(playerPos.z - objPos.z, 2)
                    );
                    
                    // –ï—Å–ª–∏ –æ–±—ä–µ–∫—Ç –±–ª–∏–∑–∫–æ (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–Ω—å—à–µ 1.5)
                    if (distance < 1.5 && !obj.hasAttribute('data-collected')) {
                        collectObject(obj);
                    }
                });
            }, 100);
        }
        
        // –§—É–Ω–∫—Ü–∏—è —Å–±–æ—Ä–∞ –æ–±—ä–µ–∫—Ç–∞
        function collectObject(object) {
            if (!gameActive || object.hasAttribute('data-collected')) return;
            
            // –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ —Å–æ–±—Ä–∞–Ω–Ω—ã–π
            object.setAttribute('data-collected', 'true');
            
            // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞
            const value = parseInt(object.getAttribute('data-value') || 1);
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç –∏ —Å—á–µ—Ç—á–∏–∫
            score += value;
            collectedObjects++;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateScore();
            updateProgress();
            
            // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫
            const sound = document.getElementById('collect-sound');
            if (sound && sound.components && sound.components.sound) {
                sound.components.sound.playSound();
            }
            
            // –°—Ä–∞–∑—É —É–¥–∞–ª—è–µ–º –æ–±—ä–µ–∫—Ç
            if (object.parentNode) {
                object.parentNode.removeChild(object);
            }
            
            // –£–¥–∞–ª—è–µ–º –∏–∑ –º–∞—Å—Å–∏–≤–∞
            const objIndex = objects.indexOf(object);
            if (objIndex > -1) {
                objects.splice(objIndex, 1);
            }
            
            // –≠—Ñ—Ñ–µ–∫—Ç —á–∞—Å—Ç–∏—Ü –ø—Ä–∏ —Å–±–æ—Ä–µ
            createParticleEffect(object.getAttribute('position'), object.getAttribute('color'));
            
            console.log(`–°–æ–±—Ä–∞–Ω –æ–±—ä–µ–∫—Ç! –û—Å—Ç–∞–ª–æ—Å—å: ${objects.length}`);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–±–µ–¥—É
            if (collectedObjects >= totalObjects) {
                endGame(true);
            }
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ —á–∞—Å—Ç–∏—Ü –ø—Ä–∏ —Å–±–æ—Ä–µ
        function createParticleEffect(position, color) {
            const scene = document.querySelector('a-scene');
            
            for (let i = 0; i < 10; i++) {
                const particle = document.createElement('a-sphere');
                particle.setAttribute('radius', '0.05');
                particle.setAttribute('color', color);
                particle.setAttribute('position', position);
                particle.setAttribute('opacity', '0.8');
                
                // –°–ª—É—á–∞–π–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                const angle = Math.random() * Math.PI * 2;
                const speed = 0.5 + Math.random() * 0.5;
                const vx = Math.cos(angle) * speed;
                const vz = Math.sin(angle) * speed;
                const vy = 1 + Math.random() * 1;
                
                let life = 0;
                const maxLife = 1000; // 1 —Å–µ–∫—É–Ω–¥–∞
                
                const animate = () => {
                    if (!particle.parentNode) return;
                    
                    life += 16; // ~60fps
                    const progress = life / maxLife;
                    
                    const currentPos = particle.getAttribute('position');
                    const newPos = {
                        x: currentPos.x + vx * 0.016,
                        y: currentPos.y + vy * 0.016 - (9.8 * progress * 0.016),
                        z: currentPos.z + vz * 0.016
                    };
                    
                    particle.setAttribute('position', newPos);
                    particle.setAttribute('opacity', 0.8 * (1 - progress));
                    
                    if (progress < 1) {
                        requestAnimationFrame(animate);
                    } else {
                        if (particle.parentNode) {
                            particle.parentNode.removeChild(particle);
                        }
                    }
                };
                
                scene.appendChild(particle);
                requestAnimationFrame(animate);
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç–∞
        function updateScore() {
            const scoreText = document.getElementById('score-text');
            scoreText.setAttribute('value', `–°—á–µ—Ç: ${score}`);
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            scoreText.setAttribute('animation', {
                property: 'scale',
                from: '2 2 2',
                to: '2.3 2.3 2.3',
                dur: 200,
                easing: 'easeOutQuad',
                direction: 'alternate'
            });
            
            setTimeout(() => {
                scoreText.removeAttribute('animation');
            }, 200);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        function updateProgress() {
            const progressText = document.getElementById('progress-text');
            progressText.setAttribute('value', `–û–±—ä–µ–∫—Ç—ã: ${collectedObjects}/${totalObjects}`);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–π–º–µ—Ä–∞
        function updateTimer() {
            const timerText = document.getElementById('timer-text');
            
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            const timeString = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            
            timerText.setAttribute('value', `–í—Ä–µ–º—è: ${timeString}`);
            
            if (timeLeft <= 10) {
                timerText.setAttribute('color', '#FF4444');
                
                if (timeLeft <= 5) {
                    timerText.setAttribute('animation', {
                        property: 'opacity',
                        from: '1',
                        to: '0.5',
                        dur: 300,
                        loop: true,
                        direction: 'alternate'
                    });
                }
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã
        function endGame(isWin) {
            if (!gameActive) return;
            
            gameActive = false;
            clearInterval(timerInterval);
            
            // –°–∫—Ä—ã–≤–∞–µ–º –∫—É—Ä—Å–æ—Ä
            const cursor = document.getElementById('cursor');
            if (cursor) {
                cursor.setAttribute('visible', 'false');
            }
            
            // –°–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
            const message = isWin 
                ? "–ü–û–ë–ï–î–ê! üéâ" 
                : "–í–†–ï–ú–Ø –í–´–®–õ–û! ‚è∞";
            
            const finalScore = `\n–°—á–µ—Ç: ${score}\n–û–±—ä–µ–∫—Ç—ã: ${collectedObjects}/${totalObjects}`;
            
            // –°–æ–∑–¥–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            const gameOverText = document.createElement('a-text');
            gameOverText.setAttribute('value', message + finalScore);
            gameOverText.setAttribute('position', '0 1 -2');
            gameOverText.setAttribute('align', 'center');
            gameOverText.setAttribute('color', isWin ? '#FFD700' : '#FF4444');
            gameOverText.setAttribute('scale', '2.5 2.5 2.5');
            gameOverText.setAttribute('font', 'mozillavr');
            
            // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
            const restartButton = document.createElement('a-text');
            restartButton.setAttribute('value', '[ –ù–ê–ß–ê–¢–¨ –ó–ê–ù–û–í–û ]');
            restartButton.setAttribute('position', '0 -0.5 -2');
            restartButton.setAttribute('align', 'center');
            restartButton.setAttribute('color', '#00FFFF');
            restartButton.setAttribute('scale', '1.5 1.5 1.5');
            restartButton.setAttribute('class', 'clickable');
            restartButton.setAttribute('font', 'mozillavr');
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
            restartButton.addEventListener('click', function() {
                location.reload();
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å—Ü–µ–Ω—É
            const messagesContainer = document.getElementById('game-messages');
            messagesContainer.innerHTML = '';
            messagesContainer.appendChild(gameOverText);
            messagesContainer.appendChild(restartButton);
            
            // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫
            const sound = document.getElementById('game-over-sound');
            if (sound && sound.components && sound.components.sound) {
                sound.components.sound.playSound();
            }
            
            console.log(`–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! ${isWin ? '–ü–æ–±–µ–¥–∞!' : '–ü–æ—Ä–∞–∂–µ–Ω–∏–µ!'}`);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        document.addEventListener('DOMContentLoaded', function() {
            console.log('–ò–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...');
            
            // –°–æ–∑–¥–∞–µ–º –Ω–µ–±–æ
            createSkyGradient();
            
            // –°–æ–∑–¥–∞–µ–º –æ–±–ª–∞–∫–∞
            createClouds();
            
            // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç—ã
            createCollectibles(totalObjects);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
            setTimeout(initCollisionDetection, 1000);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateScore();
            updateTimer();
            updateProgress();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
            timerInterval = setInterval(() => {
                if (!gameActive) return;
                
                timeLeft--;
                updateTimer();
                
                if (timeLeft <= 0) {
                    endGame(false);
                }
            }, 1000);
            
            console.log('–ò–≥—Ä–∞ –∑–∞–ø—É—â–µ–Ω–∞! –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: WASD –¥–ª—è –¥–≤–∏–∂–µ–Ω–∏—è, –º—ã—à—å –¥–ª—è –æ–±–∑–æ—Ä–∞');
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∞–≤–∏—à–∏ R –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
        document.addEventListener('keydown', function(e) {
            if (e.key === 'r' || e.key === 'R') {
                location.reload();
            }
            if (e.key === 'Escape') {
                const instructions = document.getElementById('instructions');
                instructions.style.display = instructions.style.display === 'none' ? 'block' : 'none';
            }
        });
    </script>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
            background: #000;
            width: 100vw;
            height: 100vh;
        }
        
        a-scene {
            width: 100%;
            height: 100%;
            display: block;
        }
        
        .clickable {
            cursor: pointer;
        }
        
        .clickable:hover {
            opacity: 0.8;
        }
        
        #instructions {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 15px;
            font-size: 14px;
            z-index: 1000;
            text-align: center;
            border: 2px solid #4CC3D9;
            max-width: 400px;
            backdrop-filter: blur(5px);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        }
        
        #instructions h3 {
            margin-top: 0;
            color: #4CC3D9;
            font-size: 18px;
        }
        
        .controls-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
        }
        
        .control-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 5px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
        }
        
        .key {
            background: #333;
            padding: 3px 8px;
            border-radius: 4px;
            font-family: monospace;
            color: #4CC3D9;
        }
        
        #loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 20px;
            z-index: 9999;
        }
    </style>
    
    <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ -->
    <div id="instructions">
        <h3>üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –ø—Ä–∞–≤–∏–ª–∞</h3>
        <div class="controls-grid">
            <div class="control-item">
                <span><strong>–î–≤–∏–∂–µ–Ω–∏–µ:</strong></span>
                <span class="key">W A S D</span>
            </div>
            <div class="control-item">
                <span><strong>–û–±–∑–æ—Ä:</strong></span>
                <span class="key">–ú—ã—à—å</span>
            </div>
            <div class="control-item">
                <span><strong>–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫:</strong></span>
                <span class="key">R</span>
            </div>
            <div class="control-item">
                <span><strong>–°–±–æ—Ä:</strong></span>
                <span>–ù–∞—Å—Ç—É–ø–∏—Ç–µ –Ω–∞ –æ–±—ä–µ–∫—Ç</span>
            </div>
        </div>
        <p style="color: #FFD700; margin: 10px 0;">
            <strong>–¶–µ–ª—å:</strong> –°–æ–±–µ—Ä–∏—Ç–µ –≤—Å–µ 20 –æ–±—ä–µ–∫—Ç–æ–≤ –∑–∞ 60 —Å–µ–∫—É–Ω–¥!
        </p>
        <p style="font-size: 12px; opacity: 0.8; margin: 10px 0;">
            –û–±—ä–µ–∫—Ç—ã —Ä–∞–∑–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤ –¥–∞—é—Ç —Ä–∞–∑–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—á–∫–æ–≤
        </p>
        <p style="font-size: 11px; opacity: 0.6; margin-top: 15px;">
            –ù–∞–∂–º–∏—Ç–µ ESC –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è/–ø–æ–∫–∞–∑–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
        </p>
    </div>
    
    <div id="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã...</div>
    
    <script>
        // –°–∫—Ä—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
        window.addEventListener('load', function() {
            const loading = document.getElementById('loading');
            const instructions = document.getElementById('instructions');
            
            setTimeout(() => {
                loading.style.display = 'none';
                instructions.style.display = 'block';
            }, 1500);
            
            // –ê–≤—Ç–æ—Å–∫—Ä—ã—Ç–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —á–µ—Ä–µ–∑ 8 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                instructions.style.opacity = '0.7';
                instructions.style.transition = 'opacity 1s';
            }, 6000);
            
            // –°–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É
            instructions.addEventListener('click', function() {
                instructions.style.display = 'none';
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –ø–æ ESC
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    instructions.style.display = instructions.style.display === 'none' ? 'block' : 'none';
                    instructions.style.opacity = '1';
                }
            });
        });
    </script>
</body>
</html>
