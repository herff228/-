<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>VR –ò–≥—Ä–∞: –°–±–æ—Ä –æ–±—ä–µ–∫—Ç–æ–≤</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
</head>
<body>
    <a-scene physics="debug: false">
        <!-- –ê—Å—Å–µ—Ç—ã (—Ä–µ—Å—É—Ä—Å—ã) -->
        <a-assets>
            <!-- 3D –º–æ–¥–µ–ª—å –¥–µ—Ä–µ–≤–∞ -->
            <a-asset-item id="tree-model" src="https://cdn.aframe.io/aframe/examples/models/gltf/tree/tree.gltf"></a-asset-item>
            
            <!-- –ó–≤—É–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) -->
            <audio id="collect-sound" src="https://cdn.aframe.io/360-image-gallery-boilerplate/audio/click.ogg"></audio>
            <audio id="game-over-sound" src="https://cdn.aframe.io/360-image-gallery-boilerplate/audio/percussion.ogg"></audio>
        </a-assets>
        
        <!-- –°–∫–∞–π–±–æ–∫—Å -->
        <a-sky src="sky.jpg" radius="100"></a-sky>
        
        <!-- –ü–æ–ª —Å —Ñ–∏–∑–∏–∫–æ–π -->
        <a-plane 
            id="ground"
            static-body
            position="0 0 0" 
            rotation="-90 0 0" 
            width="30" 
            height="30" 
            color="#4a752c"
            roughness="0.8"
            repeat="10 10"
        ></a-plane>
        
        <!-- –ò–≥—Ä–æ–∫ -->
        <a-entity id="player" position="0 1.6 5">
            <a-camera 
                id="camera"
                look-controls="pointerLockEnabled: true"
                wasd-controls="acceleration: 65; fly: true"
                position="0 1.6 0"
            >
                <a-cursor 
                    id="cursor"
                    fuse="true"
                    fuse-timeout="100"
                    animation__click="property: scale; startEvents: click; from: 0.1 0.1 0.1; to: 1 1 1; dur: 150"
                ></a-cursor>
            </a-camera>
        </a-entity>
        
        <!-- –û–±—ä–µ–∫—Ç—ã –¥–ª—è —Å–±–æ—Ä–∞ -->
        <!-- –ó–æ–ª–æ—Ç—ã–µ –º–æ–Ω–µ—Ç—ã -->
        <a-entity 
            class="collectible"
            gltf-model="#tree-model"
            position="-6 2 -4"
            scale="0.5 0.5 0.5"
            animation="property: rotation; to: 0 360 0; loop: true; dur: 4000"
            dynamic-body="shape: box; mass: 0"
            data-value="10"
        ></a-entity>
        
        <a-sphere 
            class="collectible"
            position="5 1.5 -8" 
            radius="0.5" 
            color="#FFD700"
            metalness="0.9"
            roughness="0.1"
            animation="property: position; dir: alternate; dur: 2000; easing: easeInOutSine; loop: true; to: 5 2.5 -8"
            dynamic-body="shape: sphere; mass: 0"
            data-value="5"
        ></a-sphere>
        
        <a-box 
            class="collectible"
            position="8 1 -2" 
            width="0.8" 
            height="0.8" 
            depth="0.8" 
            color="#C0C0C0"
            metalness="0.8"
            animation="property: rotation; to: 360 360 360; loop: true; dur: 5000"
            dynamic-body="shape: box; mass: 0"
            data-value="3"
        ></a-box>
        
        <a-cylinder 
            class="collectible"
            position="-8 1 -6" 
            radius="0.4" 
            height="1" 
            color="#FF6B6B"
            animation="property: rotation; to: 0 360 0; loop: true; dur: 3000"
            dynamic-body="shape: cylinder; mass: 0"
            data-value="2"
        ></a-cylinder>
        
        <a-cone 
            class="collectible"
            position="0 1 -12" 
            radius-bottom="0.5" 
            height="1" 
            color="#4ECDC4"
            animation="property: position.y; dir: alternate; dur: 1500; easing: easeInOutSine; loop: true; to: 2"
            dynamic-body="shape: cone; mass: 0"
            data-value="7"
        ></a-cone>
        
        <!-- –î–µ–∫–æ—Ä–∞—Ü–∏–∏ -->
        <a-box 
            position="-10 0.5 0" 
            width="2" 
            height="1" 
            depth="2" 
            color="#8B4513"
        ></a-box>
        
        <a-box 
            position="10 0.5 0" 
            width="3" 
            height="1.5" 
            depth="3" 
            color="#A0522D"
        ></a-box>
        
        <!-- UI: –°—á–µ—Ç -->
        <a-entity position="0 3 -1.5">
            <a-text 
                id="score-text" 
                value="–°—á–µ—Ç: 0" 
                position="0 0 0" 
                color="#FFFFFF" 
                align="center"
                scale="2 2 2"
                font="https://cdn.aframe.io/fonts/Exo2SemiBold.fnt"
            ></a-text>
        </a-entity>
        
        <!-- UI: –¢–∞–π–º–µ—Ä -->
        <a-entity position="0 2.5 -1.5">
            <a-text 
                id="timer-text" 
                value="–í—Ä–µ–º—è: 60" 
                position="0 0 0" 
                color="#FFFFFF" 
                align="center"
                scale="1.5 1.5 1.5"
                font="https://cdn.aframe.io/fonts/Exo2SemiBold.fnt"
            ></a-text>
        </a-entity>
        
        <!-- UI: –°–æ–æ–±—â–µ–Ω–∏—è -->
        <a-entity id="game-messages" position="0 0 -1.5"></a-entity>
        
        <!-- –û—Å–≤–µ—â–µ–Ω–∏–µ -->
        <a-light type="ambient" color="#FFFFFF" intensity="0.6"></a-light>
        <a-light type="directional" color="#FFFFFF" intensity="0.8" position="-1 2 1"></a-light>
        <a-light type="point" color="#FFD700" intensity="1" distance="8" position="5 3 -8"></a-light>
        
        <!-- –§–æ–Ω–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã -->
        <a-entity particle-system="preset: snow; color: #FFFFFF; particleCount: 200"></a-entity>
    </a-scene>
    
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–≥—Ä—ã
        let score = 0;
        let timeLeft = 60; // 60 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∏–≥—Ä—É
        let gameActive = true;
        let timerInterval;
        let collectedObjects = 0;
        let totalObjects = document.querySelectorAll('.collectible').length;
        
        // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
        AFRAME.registerComponent('collision-collect', {
            init: function() {
                this.el.addEventListener('collide', (e) => {
                    if (!gameActive) return;
                    
                    const other = e.detail.body.el;
                    
                    if (other.classList.contains('collectible')) {
                        this.collectObject(other);
                    }
                });
            },
            
            collectObject: function(object) {
                if (!object.hasAttribute('data-collected')) {
                    // –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ —Å–æ–±—Ä–∞–Ω–Ω—ã–π
                    object.setAttribute('data-collected', 'true');
                    
                    // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞
                    const value = parseInt(object.getAttribute('data-value') || 1);
                    
                    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç
                    score += value;
                    collectedObjects++;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º UI
                    updateScore();
                    
                    // –≠—Ñ—Ñ–µ–∫—Ç —Å–±–æ—Ä–∞
                    object.setAttribute('animation', {
                        property: 'scale',
                        to: '0 0 0',
                        dur: 300,
                        easing: 'easeOutQuad'
                    });
                    
                    // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫
                    const sound = document.querySelector('#collect-sound');
                    if (sound) {
                        sound.components.sound.playSound();
                    }
                    
                    // –£–¥–∞–ª—è–µ–º –æ–±—ä–µ–∫—Ç –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
                    setTimeout(() => {
                        object.parentNode.removeChild(object);
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–±–µ–¥—É
                        if (collectedObjects >= totalObjects) {
                            endGame(true);
                        }
                    }, 300);
                }
            }
        });
        
        // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∫–ª–∏–∫–æ–≤ (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–±–æ—Ä–∞)
        AFRAME.registerComponent('click-collect', {
            init: function() {
                this.el.addEventListener('click', () => {
                    if (!gameActive) return;
                    
                    if (this.el.classList.contains('collectible') && !this.el.hasAttribute('data-collected')) {
                        const value = parseInt(this.el.getAttribute('data-value') || 1);
                        
                        // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç
                        score += value;
                        collectedObjects++;
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º UI
                        updateScore();
                        
                        // –≠—Ñ—Ñ–µ–∫—Ç —Å–±–æ—Ä–∞
                        this.el.setAttribute('animation', {
                            property: 'scale',
                            to: '0 0 0',
                            dur: 300,
                            easing: 'easeOutQuad'
                        });
                        
                        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫
                        const sound = document.querySelector('#collect-sound');
                        if (sound) {
                            sound.components.sound.playSound();
                        }
                        
                        // –£–¥–∞–ª—è–µ–º –æ–±—ä–µ–∫—Ç –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
                        setTimeout(() => {
                            this.el.parentNode.removeChild(this.el);
                            
                            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–±–µ–¥—É
                            if (collectedObjects >= totalObjects) {
                                endGame(true);
                            }
                        }, 300);
                        
                        this.el.setAttribute('data-collected', 'true');
                    }
                });
            }
        });
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç–∞
        function updateScore() {
            const scoreText = document.querySelector('#score-text');
            scoreText.setAttribute('value', `–°—á–µ—Ç: ${score}`);
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç–∞
            scoreText.setAttribute('animation', {
                property: 'scale',
                from: '2 2 2',
                to: '2.5 2.5 2.5',
                dur: 200,
                easing: 'easeOutQuad',
                direction: 'alternate'
            });
            
            setTimeout(() => {
                scoreText.removeAttribute('animation');
            }, 200);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–π–º–µ—Ä–∞
        function updateTimer() {
            const timerText = document.querySelector('#timer-text');
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            const timeString = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            
            timerText.setAttribute('value', `–í—Ä–µ–º—è: ${timeString}`);
            
            // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ –ø—Ä–∏ –º–∞–ª–æ–º –≤—Ä–µ–º–µ–Ω–∏
            if (timeLeft <= 10) {
                timerText.setAttribute('color', '#FF4444');
                
                // –ú–∏–≥–∞–Ω–∏–µ
                if (timeLeft <= 5) {
                    timerText.setAttribute('animation', {
                        property: 'opacity',
                        from: '1',
                        to: '0.3',
                        dur: 500,
                        loop: true,
                        direction: 'alternate'
                    });
                }
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã
        function endGame(isWin) {
            gameActive = false;
            clearInterval(timerInterval);
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –∞–Ω–∏–º–∞—Ü–∏–∏
            document.querySelectorAll('.collectible').forEach(obj => {
                obj.removeAttribute('animation');
            });
            
            // –°–∫—Ä—ã–≤–∞–µ–º –∫—É—Ä—Å–æ—Ä
            const cursor = document.querySelector('#cursor');
            if (cursor) {
                cursor.setAttribute('visible', 'false');
            }
            
            // –°–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
            const message = isWin 
                ? "win!" 
                : "lost!";
            
            const finalScore = `\n–ò—Ç–æ–≥–æ–≤—ã–π —Å—á–µ—Ç: ${score} –æ—á–∫–æ–≤\n–°–æ–±—Ä–∞–Ω–æ –æ–±—ä–µ–∫—Ç–æ–≤: ${collectedObjects}/${totalObjects}`;
            
            // –°–æ–∑–¥–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            const gameOverText = document.createElement('a-text');
            gameOverText.setAttribute('value', message + finalScore);
            gameOverText.setAttribute('position', '0 1 -2');
            gameOverText.setAttribute('align', 'center');
            gameOverText.setAttribute('color', isWin ? '#FFD700' : '#FF4444');
            gameOverText.setAttribute('scale', '3 3 3');
            gameOverText.setAttribute('font', 'https://cdn.aframe.io/fonts/Exo2Bold.fnt');
            
            // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
            const restartButton = document.createElement('a-text');
            restartButton.setAttribute('value', '[ –ù–ê–ß–ê–¢–¨ –ó–ê–ù–û–í–û ]');
            restartButton.setAttribute('position', '0 -0.5 -2');
            restartButton.setAttribute('align', 'center');
            restartButton.setAttribute('color', '#00FFFF');
            restartButton.setAttribute('scale', '2 2 2');
            restartButton.setAttribute('class', 'clickable');
            restartButton.setAttribute('font', 'https://cdn.aframe.io/fonts/Exo2SemiBold.fnt');
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
            gameOverText.setAttribute('animation', {
                property: 'scale',
                from: '0 0 0',
                to: '3 3 3',
                dur: 1000,
                easing: 'easeOutElastic'
            });
            
            restartButton.setAttribute('animation', {
                property: 'scale',
                from: '0 0 0',
                to: '2 2 2',
                dur: 1000,
                easing: 'easeOutElastic',
                delay: 500
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
            restartButton.addEventListener('click', function() {
                location.reload();
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å—Ü–µ–Ω—É
            const messagesContainer = document.querySelector('#game-messages');
            messagesContainer.appendChild(gameOverText);
            messagesContainer.appendChild(restartButton);
            
            // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
            const sound = document.querySelector('#game-over-sound');
            if (sound) {
                sound.components.sound.playSound();
            }
            
            // –í–∏–±—Ä–∞—Ü–∏—è (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
            if (navigator.vibrate) {
                navigator.vibrate(isWin ? [100, 50, 100] : [500]);
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π –∏–≥—Ä–æ–∫—É
            const player = document.querySelector('#player');
            player.setAttribute('collision-collect', '');
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–ª–∏–∫–æ–≤ –æ–±—ä–µ–∫—Ç–∞–º
            document.querySelectorAll('.collectible').forEach(obj => {
                obj.setAttribute('click-collect', '');
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—á–µ—Ç–∞ –∏ —Ç–∞–π–º–µ—Ä–∞
            updateScore();
            updateTimer();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
            timerInterval = setInterval(() => {
                if (!gameActive) return;
                
                timeLeft--;
                updateTimer();
                
                if (timeLeft <= 0) {
                    endGame(false);
                }
            }, 1000);
            
            // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏
            console.log('–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:');
            console.log('- WASD: –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ');
            console.log('- –ú—ã—à–∫–∞: –ø–æ–≤–æ—Ä–æ—Ç –∫–∞–º–µ—Ä—ã');
            console.log('- –ö–ª–∏–∫: —Å–±–æ—Ä –æ–±—ä–µ–∫—Ç–æ–≤');
            console.log('- –¶–µ–ª—å: —Å–æ–±—Ä–∞—Ç—å –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã –∑–∞ 60 —Å–µ–∫—É–Ω–¥!');
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏
        window.addEventListener('model-error', function(e) {
            console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å 3D –º–æ–¥–µ–ª—å:', e.detail.src);
            
            // –ó–∞–º–µ–Ω—è–µ–º –º–æ–¥–µ–ª—å –Ω–∞ –ø—Ä–æ—Å—Ç—É—é –≥–µ–æ–º–µ—Ç—Ä–∏—é
            const model = e.target;
            if (model.id === 'tree-model') {
                model.parentNode.innerHTML = `
                    <a-cone 
                        position="0 0 0" 
                        radius-bottom="0.5" 
                        height="2" 
                        color="#228B22"
                        rotation="0 45 0"
                    ></a-cone>
                `;
            }
        });
    </script>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        
        a-scene {
            width: 100vw;
            height: 100vh;
        }
        
        .clickable {
            cursor: pointer;
        }
        
        .clickable:hover {
            opacity: 0.8;
        }
        
        /* –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ */
        @media (min-width: 768px) {
            #instructions {
                position: absolute;
                bottom: 20px;
                left: 20px;
                color: white;
                background: rgba(0,0,0,0.5);
                padding: 10px;
                border-radius: 5px;
                font-size: 14px;
                z-index: 1000;
            }
        }
    </style>
    
    <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ -->
    <div id="instructions" style="display: none;">
        <p>üéÆ <strong>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</strong></p>
        <p>WASD - –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ</p>
        <p>–ú—ã—à—å - –ü–æ–≤–æ—Ä–æ—Ç –∫–∞–º–µ—Ä—ã</p>
        <p>–ö–ª–∏–∫ - –°–±–æ—Ä –æ–±—ä–µ–∫—Ç–æ–≤</p>
        <p>–¶–µ–ª—å: –°–æ–±—Ä–∞—Ç—å –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã –∑–∞ 60 —Å–µ–∫—É–Ω–¥!</p>
    </div>
    
    <script>
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–∞ 5 —Å–µ–∫—É–Ω–¥
        window.addEventListener('load', function() {
            const instructions = document.querySelector('#instructions');
            instructions.style.display = 'block';
            
            setTimeout(() => {
                instructions.style.display = 'none';
            }, 5000);
        });
    </script>
</body>
</html>



